<!-- 
#################################################
# HEAD - FOR ALL PAGES
#################################################
 --><!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name="author" content="Martin Alfaro"><script>function applySavedTheme(){"enabled"===localStorage.getItem("darkMode")&&document.documentElement.classList.add("dark-mode")}applySavedTheme()</script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Cormorant+SC:wght@300;400;600;700&family=Inter:wght@300..900&family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet"><link rel="stylesheet" href="/julia_book/libs/katex/katex.min.css"><link rel="stylesheet" href="/julia_book/libs/highlight/styles/vs_myversion.css"><link rel="stylesheet" href="/julia_book/css/bootstrap.min.css"><style>.section-bg-color{background-color:rgba(63,99,136,.07)}footer a{color:#6495ed}header{margin-top:0!important}header .jumbotron{background-image:linear-gradient(to right,#000,#000 10%,#3f6388 55%,#3f6388);background-repeat:no-repeat;background-size:100%}</style><link rel="stylesheet" href="/julia_book/css/custom.css"><title>10f. SIMD: Branchless Code - Julia Book - Martin Alfaro</title><link rel="icon" type="image/png" href="/julia_book/assets/icons/favicon.ico"></head><script async src="https://www.googletagmanager.com/gtag/js?id=G-K96JNP7PKB"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-K96JNP7PKB")</script><body id="page-top"><!-- 
#################################################
# FOR EACH SPECIFIC PAGE
#################################################
 --><style>html{scroll-behavior:auto}.bar_top,.jumbotron,.left_bar,.nav-item,.navbar,footer{font-size:16px;font-family:"Open Sans"}.franklin-content{font-size:17px;font-family:"Open Sans"}h1{font-family:Inter,"Open Sans";font-weight:600}h1{padding-top:.1em;font-size:210%!important;font-weight:700;text-align:center}.phd_format{color:#fff;text-decoration:none;font-size:90%;text-align:center;margin-top:-.2em;margin-bottom:-.89em}.name_format{padding-top:.35em;text-decoration:none;font-size:160%}.name_format a{color:#fff}.name_format a:hover{color:#d4d4d4;color:#d6e3f0}.franklin-content{background-color:#d9e0e7}.franklin-content{margin:0;width:100%;height:100%;justify-content:center;text-align:justify;text-justify:inter-word;line-height:1.65}.jumbotron{margin-bottom:0;padding-top:42px;padding-bottom:2em;border-bottom:#000 solid 1px;border-radius:0}.franklin-content,.jumbotron{padding-left:160px}footer{background-image:linear-gradient(to right,#23374b,#000 50%,#3f6388);background-color:#3f6388;width:calc(100%+10px);margin-left:-10px;padding-left:10px}h2{text-transform:uppercase;font-size:160%;text-align:center;text-decoration:underline;padding-bottom:.5em;font-weight:700}h3{text-align:left;text-transform:uppercase;text-decoration:underline;padding-bottom:0;padding-top:.5em;font-size:120%;font-weight:600}h4 a{font-weight:800!important}h4{text-align:left;color:#3a6c9e;text-decoration:underline;padding-bottom:0;padding-top:.5em;font-weight:800!important;text-transform:uppercase;font-size:120%}h5,h6{text-indent:0;line-height:1.2em;padding-top:.99em;padding-bottom:-0em}section{margin-left:0;padding-left:1%;padding-right:1%;padding-top:1.5%;padding-bottom:1%;text-align:justify;text-justify:inter-word;line-height:1.65;text-indent:0;font-size:100%;color:#000}section h1{text-indent:0;margin-left:0}section h2{text-indent:0;margin-bottom:0}.franklin-content ul{margin-left:0;margin-top:-.6em;line-height:1.15}.franklin-content ul li p{margin-left:0;margin-bottom:.6em;line-height:1.35;text-indent:0}.franklin-content ol li{margin-left:2em;line-height:1.15}ul ::marker{color:#49739d}ol ::marker{color:#5381af;font-weight:700}a.anchor{display:block;position:relative;top:-150px;visibility:hidden}section a{color:#3e79b4;text-decoration:underline;font-weight:500}section a:hover{color:rgba(62,121,180,.699);text-decoration:underline}</style><style>:target{scroll-margin-top:40px}.own-anchors a{scroll-margin-top:4em}</style><div class="left_bar" style="color:#fff"><span><img src="/julia_book/assets/pics_html/julia_logo-dark.svg" alt="pic" style="padding:12px;padding-right:28px;padding-top:44px" width="160px" height="auto"></span><ul><li style="text-transform:uppercase"><a href="/julia_book/index.html"><img src="/julia_book/assets/icons/home.png" style="width:15%;height:auto;opacity:.9;padding-bottom:5px"> Home</a></li><li style="text-transform:uppercase"><a href="/julia_book/list_posts/"><img src="/julia_book/assets/icons/books03.png" style="width:15%;height:auto;opacity:.9;padding-bottom:5px"> Chapters</a></li><li><div style="text-indent:0"><button class="modalButton" style="text-transform:uppercase"><img src="/julia_book/assets/icons/keyboard01.png" style="width:20%;height:auto;opacity:.9;margin-bottom:-26px;margin-left:-30px;padding-right:4px"> <span style="margin-left:-.2em">Notation &<div style="margin-left:-1.2em;margin-top:-3em">Hotkeys</div></span></button><div class="kbd_shortcuts"><div class="modal" id="kbdmodal_bar"><div class="modal-content"><div class="modal-header"><h2>NOTATION</h2></div><div class="modal-body" style="height:auto">Generic expressions are represented by <b>&lt;something&gt;</b> (e.g., <code>&lt;function&gt;</code> or <code>&lt;operator&gt;</code>). This is just notation, and the symbols <code>&lt;</code> and <code>&gt;</code> should not be misconstrued as Julia's syntax.</div><div class="modal-header"><h2>PAGE LAYOUT</h2></div><div class="modal-body">If you want to adjust the size of the font, <b>zoom in or out on pages</b> by respectively using <kbd>Ctrl</kbd>+<kbd>+</kbd> and <kbd>Ctrl</kbd>+<kbd>-</kbd>. The layout will adjust automatically.<br><span class="brmine"></span></div><div class="modal-header"><h2>LINKS TO SECTIONS</h2></div><div class="modal-body">To quickly share a link to a specific section, simply hover over the title and click on it. The link will be automatically copied to your clipboard, ready to be pasted. <span class="brmine"></span></div><div class="modal-header"><h2>KEYBOARD SHORTCUTS</h2></div><div class="modal-body"><style type="text/css">.tg{border-collapse:collapse;border-spacing:0}.tg td{border-color:#000;border-style:solid;border-width:1px;overflow:hidden;padding:10px 12px;word-break:normal}.tg th{border-color:#000;border-style:solid;border-width:1px;font-weight:400;overflow:hidden;padding:10px 5px;word-break:normal}.tg .tg-80zn{background-color:rgba(63,99,136,.2);border-color:#fff;font-weight:700;text-align:center;vertical-align:top}.tg .tg-esg4{background-color:#ebebeb;border-color:#fff;font-weight:700;text-align:right;vertical-align:top}.tg .tg-8jgo{border-color:#fff;text-align:left;vertical-align:top}.tg .tg-ofj5{border-color:#fff;text-align:center;vertical-align:top}</style><table class="tg" style="margin-left:auto;margin-right:auto"><thead><tr><th class="tg-80zn">Action</th><th class="tg-80zn">Keyboard Shortcut</th></tr></thead><tbody><tr><td class="tg-8jgo">Previous Section</td><td class="tg-ofj5"><kbd>Ctrl + ðŸ ˜</kbd></td></tr><tr><td class="tg-8jgo">Next Section</td><td class="tg-ofj5"><kbd>Ctrl + ðŸ š</kbd></td></tr><tr><td class="tg-8jgo">List of Sections</td><td class="tg-ofj5"><kbd>Ctrl + z</kbd></td></tr><tr><td class="tg-8jgo">List of Subsections</td><td class="tg-ofj5"><kbd>Ctrl + x</kbd></td></tr><tr><td class="tg-8jgo">Close Any Popped Up Window (like this one)</td><td class="tg-ofj5"><kbd>Esc</kbd></td></tr><tr><td class="tg-8jgo">Open All Codes and Outputs in a Post</td><td class="tg-ofj5"><kbd>Alt + ðŸ ›</kbd></td></tr><tr><td class="tg-8jgo">Close All Codes and Outputs in a Post</td><td class="tg-ofj5"><kbd>Alt + ðŸ ™</kbd></td></tr></tbody></table><span class="brmine"></span></div><div class="modal-header"><h2>TIME MEASUREMENT</h2></div><div class="modal-body">When benchmarking, the equivalence of time measures is as follows.<br><br><style type="text/css">.tg{border-collapse:collapse;border-spacing:0}.tg td{border-color:#000;border-style:solid;border-width:1px;overflow:hidden;padding:10px 5px;word-break:normal}.tg th{border-color:#000;border-style:solid;border-width:1px;font-weight:400;overflow:hidden;padding:10px 5px;word-break:normal}.tg .tg-80zn{background-color:#ebebeb;border-color:#fff;font-weight:700;text-align:left;vertical-align:top}.tg .tg-esg4{background-color:#ebebeb;border-color:#fff;font-weight:700;text-align:right;vertical-align:top}.tg .tg-8jgo{border-color:#fff;text-align:left;vertical-align:top}.tg .tg-ofj5{border-color:#fff;text-align:center;vertical-align:top}</style><table class="tg" style="margin-left:auto;margin-right:auto"><thead><tr><th class="tg-80zn">Unit</th><th class="tg-80zn">Acronym</th><th class="tg-80zn">Measure in Seconds</th></tr></thead><tbody><tr><td class="tg-8jgo">Seconds</td><td class="tg-ofj5">s</td><td class="tg-ofj5">1</td></tr><tr><td class="tg-8jgo">Milliseconds</td><td class="tg-ofj5">ms</td><td class="tg-ofj5">10<sup>-3</sup></td></tr><tr><td class="tg-8jgo">Microseconds</td><td class="tg-ofj5">Î¼s</td><td class="tg-ofj5">10<sup>-6</sup></td></tr><tr><td class="tg-8jgo">Nanoseconds</td><td class="tg-ofj5">ns</td><td class="tg-ofj5">10<sup>-9</sup></td></tr></tbody></table></div></div><style>.left_bar .kbd_shortcuts{color:#000;font-size:16px;line-height:1.55;list-style-type:none;position:relative}.left_bar .kbd_shortcuts kbd{font-size:14px}.left_bar .kbd_shortcuts .modal-content{position:relative;width:1200px;max-width:90%;height:max-content;max-height:90%;margin-top:55px;background-color:#cfdae4;overflow:auto}.left_bar .kbd_shortcuts .modal-body{margin:0;padding-bottom:12px;text-align:justify;padding-top:8px;padding-bottom:2px;overflow:visible;height:100%}.left_bar .kbd_shortcuts .modal-header{padding:0;color:#fff;width:100%}.left_bar .kbd_shortcuts .modal-header h2{padding-top:8px;font-size:20px;font-weight:700;width:100%;text-align:center;color:#fff;background-color:#3f6388}.left_bar .modalButton{border:none;box-shadow:none;width:auto;padding:0;background-color:transparent;color:#fff;margin:0}.left_bar .brmine{display:block;margin-bottom:.5em}</style></div></div></div></li><li style="text-transform:uppercase"><a href="/julia_book/links/"><img src="/julia_book/assets/icons/links.png" style="width:15%;height:auto;opacity:.9;padding-bottom:5px"> Links</a></li><li><a href="/julia_book/assets/pdf/juliaBook_Alfaro.pdf"><img src="/julia_book/assets/icons/icon_pdf.png" style="width:15%;height:auto;opacity:.9;padding-bottom:5px"> BOOK in PDF</a></li><li><h3 style="font-weight:400;font-size:14px;padding-top:4em;margin-bottom:-.6em;text-decoration:none">Dark Mode</h3><label class="switch"><input type="checkbox" id="toggleStyles"> <span class="slider round"></span></label></li></ul><div class="searchForm"><form action="https://duckduckgo.com/" method="get" onsubmit="return prependSiteOperator()"><input type="text" id="searchInput" name="q" placeholder="Search..." required></form></div><div class="personal_website"><a href="https://alfaromartino.github.io"><img src="/julia_book/assets/icons/personal.png" style="width:18%;height:auto;opacity:.9;margin-bottom:-14px;padding-right:4px"> Personal<div style="margin-left:calc(30px + 2px);margin-top:-.5em">Website</div></a></div></div><style>@media (max-width:850px),(max-height:600px){.left_bar{display:none}}.left_bar{z-index:200;background-image:linear-gradient(to left bottom,#000,#000 10%,#3f6388 80%,#3f6388);position:fixed;font-family:Inter,"Open Sans";height:100%;top:0;left:0;font-size:20px;width:160px}.left_bar ul{list-style-type:none;float:left;font-size:80%;position:relative;padding-left:.8em;padding-top:40px;line-height:4.25em}.left_bar .personal_website a,.left_bar li a{color:#fff}.left_bar .personal_website a:hover,.left_bar a:hover{color:#a09f9f}.left_bar .personal_website{position:absolute;bottom:0;padding-bottom:1em;left:12px;font-size:20px;font-family:"Cormorant SC";font-weight:700}</style><script>function prependSiteOperator(){var e=document.getElementById("searchInput");return e.value="site:https://alfaromartino.github.io/julia_book/ "+e.value,!0}</script><style>.left_bar .searchForm{width:100%}.left_bar .searchForm input[type=text]{width:100%;box-sizing:border-box;background-color:inherit;border:0 solid;border-color:#fff;height:60px;color:#fff;padding-left:.6em;font-size:85%}</style><style>.switch{position:relative;display:inline-block;width:30px;height:17px}.switch input{display:none}.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:#ccc;transition:.4s}.slider:before{position:absolute;content:"";height:13px;width:13px;left:2px;bottom:2px;background-color:#fff;transition:.4s}input:checked+.slider{background-color:#000}input:checked+.slider:before{transform:translateX(13px)}.slider.round{border-radius:17px}.slider.round:before{border-radius:50%}html.dark-mode{background-color:#030911!important}html.dark-mode .franklin-content,html.dark-mode .modal-body{background-color:#030911!important}html.dark-mode .franklin-content section,html.dark-mode .index_container,html.dark-mode .modal-content{color:#ebf4fc!important}html.dark-mode .index_container,html.dark-mode .index_container h1{background-color:#030d18!important}html.dark-mode .index_container ul>li{color:#ebf4fc!important}html.dark-mode .index_container a{color:#588cc0}html.dark-mode .index_container a:hover,html.dark-mode h2:hover,html.dark-mode section a:hover{color:#bed5ec}html.dark-mode .multiple_pics{background-color:#4b6d92}html.dark-mode .multiple_pics h2{color:#fff!important}html.dark-mode .note,html.dark-mode .warning{color:#000}html.dark-mode .code_box,html.dark-mode .code_in_modal,html.dark-mode .img_output_in_modal,html.dark-mode .output_in_modal{border-width:1px;border-style:solid;border-color:rgba(0,44,82,.99)}html.dark-mode .tab_wrapper .tab_code_links .tablink.active{background-color:rgba(94,140,185,.95)}html.dark-mode .tab_wrapper .tab_code_links .tablink:hover{background-color:rgba(94,140,185,.95)}html.dark-mode .bar_top,html.dark-mode .nav-menu.show,html.dark-mode nav .nav-toggle{background-image:linear-gradient(to top,#122030,#122030 60%)!important}html.dark-mode .bar_top .modal-body,html.dark-mode .bar_top .modal-content,html.dark-mode .bar_top .modal-header{background-image:linear-gradient(to top,#122030,#122030 60%)!important}html.dark-mode header .jumbotron{background-image:linear-gradient(to bottom,#122030,#122030 50%)!important}html.dark-mode .left_bar{background-image:linear-gradient(to left bottom,#122030,#122030 10%)}html.dark-mode footer{background-image:linear-gradient(to right,#122030,#000 10%)!important;border-top:1px solid rgba(0,44,82,.99);background-color:rgba(63,99,136,.3);width:calc(100%+10px);margin-left:0;padding-left:10px}html.dark-mode .left_bar .kbd_shortcuts .modal-content{background-color:#000!important}</style><script>document.addEventListener("DOMContentLoaded",function(){const e=document.getElementById("toggleStyles"),t=document.documentElement;"enabled"===localStorage.getItem("darkMode")&&(e.checked=!0),e.addEventListener("change",function(){this.checked?(t.classList.add("dark-mode"),localStorage.setItem("darkMode","enabled")):(t.classList.remove("dark-mode"),localStorage.setItem("darkMode","disabled"))})})</script><header class="text-white text-center"><div class="jumbotron jumbotron-fluid container-fluid bg-primary"><h1><i>10f.</i> SIMD: Branchless Code</h1><div class="lead"></div><div class="name_format"><a href="https://alfaromartino.github.io/" target="_blank" rel="noopener noreferrer">Martin Alfaro</a></div><div class="phd_format">PhD in Economics</div></div></header><link href="https://fonts.cdnfonts.com/css/cascadia-mono" rel="stylesheet"><style>pre{position:relative;overflow:hidden}code{background-color:#d1d9e0;color:#000;text-indent:0;padding-top:.1em;padding-bottom:.1em;padding-left:.3em;padding-right:.3em;vertical-align:.05em;border:1px solid #001029;overflow:hidden}.julia_repl_NoFormat code,.mixed_output_NoFormat code{background-color:#527868;color:#dcdcdc;border:1px solid #527868}.copy-button{cursor:pointer;border:none;font-size:12px;text-transform:lowercase;font-weight:500;padding:2px 10px 2px;background-color:#3f6388;position:absolute;top:0;right:12px;text-align:center;color:#fff;margin-top:0;z-index:1}.copy-button:hover{outline:0;background-color:#5483b3}.copy-button:focus{outline:0;background-color:#324e6b}.julia_line{color:#20c679!important;font-weight:700;display:inline;font-size:100%}.julia_repl_NoFormat{font-size:87%}.julia_repl_NoFormat .julia_line,.julia_repl_NoFormat code{font-size:100%}.mixed_output_NoFormat{font-size:87%}.mixed_output_NoFormat .julia_line,.mixed_output_NoFormat code,.mixed_output_NoFormat pre{font-size:100%}.akin_to_pre{white-space:pre-wrap;font-family:Consolas,monospace}.julia_repl_NoFormat{font-family:Consolas,monospace;color:#dcdcdc;border:none;background-color:#013b1f;margin:0;padding:0}.julia_repl_NoFormat .akin_to_pre{line-height:1.35;color:#dcdcdc;margin:0;padding:0}.franklin_output_NoFormat{font-family:Consolas,monospace;margin:0;padding:0;background-color:#013b1f}.franklin_output_NoFormat pre{margin:0;padding:0;line-height:1.35;background-color:#013b1f}.franklin_output_NoFormat pre code{margin:0!important;padding:0!important;border:none;background-color:#013b1f}.mixed_output_NoFormat{font-family:Consolas,monospace;color:#dcdcdc;border:none;background-color:#013b1f;margin:0;padding:0}.mixed_output_NoFormat pre{line-height:1.35;color:#dcdcdc;margin:0;padding:0}.mixed_output_NoFormat pre code{margin:0!important;padding:0!important;border:none;background-color:#013b1f}.mixed_output_inline{color:#dcdcdc;font-family:Consolas,monospace;background-color:#013b1f;padding-left:1em;padding-top:.5em;padding-bottom:1em;margin-top:0;margin-bottom:0}.output_box{margin:0;padding:0}.output_box details>summary{width:max-content;max-width:90%;padding-left:10px;padding-right:10px;background-color:#3f6b4b;cursor:pointer;color:#fff;box-shadow:3px 3px 4px #000;text-indent:0}.output_box details[open]>summary{width:max-content;max-width:90%;padding-left:10px;padding-right:10px;background-color:#3f6b4b;border:#282c34;border-width:1px;border-style:solid}.output_box{padding-top:.5em;padding-bottom:1em;margin-top:0;margin-bottom:1em}.code_NoFormat{line-height:1.45;margin:0;padding:0;background-color:#001029}.code_NoFormat pre{margin:0;padding:0;background-color:#001029}.code_NoFormat pre code{font-family:"Cascadia Mono",monospace;margin:0!important;padding:0!important;border:none;background-color:#001029}.code_NoFormat p{padding:0;margin:0}.code_inline{background-color:#001029;padding-left:1em;padding-top:.5em;padding-bottom:1em;margin-top:0;margin-bottom:0}.code_box{margin:0;padding:0}.code_box details>summary{width:max-content;max-width:90%;padding-left:10px;padding-right:10px;background-color:#3f6388;cursor:pointer;color:#fff;box-shadow:3px 3px 4px #000;text-indent:0}.code_box details[open]>summary{width:max-content;max-width:90%;padding-left:10px;padding-right:10px;background-color:#3f6388;border:#282c34;border-width:1px;border-style:solid}.code_box{padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:1em}.hide_tab{padding-top:0;padding-bottom:0;margin-top:0;margin-bottom:1em}.hide_tab>details>summary{max-width:100%;min-width:30px;width:fit-content;padding-left:11px;padding-right:0;padding-bottom:0;background-color:#3f6388;cursor:pointer;color:#fff;text-indent:0;border:#282c34;border-width:1px;border-style:solid}.hide_tab>details[open]>summary .closed_text{display:none}.hide_tab>details>summary .closed_text{padding-left:1em;padding-right:1em;margin-left:.25em;display:inline-block;border-left:#282c34;border-width:1px;border-style:solid;border-bottom:none;border-top:none;border-right:none}.hide_tab>details[open]>summary{position:absolute;width:35px;max-width:90%;height:1.94em;padding-bottom:0;padding-top:3px;padding-left:12px;padding-right:5px;background-color:#3f6388;border:#282c34;border-width:1px;border-style:solid;border-bottom:none}.tab_wrapper{width:100%;display:inline-block}.tab_wrapper .tab_code_links{background-color:#001029}.tab_wrapper .tab_code_links .tablink{background-color:#3f6388;color:#fff;float:left;border:1px solid #000;outline:0;cursor:pointer;padding:2px 20px;width:max-content;height:auto}.tab_wrapper .tab_code_links .tablink.first_tab{padding-left:54px}.tab_wrapper .tab_code_links .tablink.active{font-weight:500;background-color:rgba(82,127,173,.836)}.tab_wrapper .tab_code_links .tablink:hover{background-color:rgba(82,127,173,.836)}.tab_wrapper .tabcontent{background-color:#001029;display:none;width:100%;float:left;margin:0;padding:0}.tab_wrapper .tabcontent.active{display:block}.code_in_modal{background-color:#001029;padding-left:1em;padding-top:.5em;padding-bottom:1em;margin-top:0;margin-bottom:0}.output_in_modal{background-color:#013b1f}.img_output,.img_output_in_modal{text-indent:0;margin:0;padding:0;background-color:#181818}.img_output_in_modal_old,.img_output_old{text-indent:0;margin:0;padding:0;background-color:#1e1e1e}.sign_output{color:#fff;width:100%;max-width:100%;height:auto;padding-bottom:0;padding-top:0;padding-left:12px;padding-right:12px;background-color:#3f6b4b;border:#282c34;border-width:1px;border-style:solid;margin-bottom:0;padding-top:0}.outputmodal_container{padding:0;margin:0}</style><style>.gif_output_in_modal{text-indent:0;margin:0;padding:0;background-color:#181818}.gif_output{position:relative;display:inline-block;cursor:pointer;margin:0;padding:0;max-width:100%}.gif-wrapper{display:block;visibility:hidden;margin:0;padding:0;max-width:100%}.gif-wrapper.playing{visibility:visible}.play-overlay{position:absolute;top:0;left:0;right:0;bottom:0;background-color:#181818;background-color:#000;display:flex;justify-content:center;align-items:center}.play-overlay.hidden{background:0 0}.play-button{background:0 0;border:none;color:#fff;cursor:pointer;padding:0;transform:scale(.5);transition:background .3s}.play-overlay.hidden .play-button{display:none}</style><script>function setMaxHeight(){const e=document.querySelectorAll(".gif-wrapper");let t=0;e.forEach(e=>{const o=e.offsetHeight;o>t&&(t=o)}),e.forEach(e=>{e.style.height=`${t}px`,e.style.width="auto"})}document.addEventListener("DOMContentLoaded",function(){const e=document.querySelectorAll(".gif_output");let t=0;e.forEach(o=>{const n=o.querySelector(".gif-wrapper"),c=o.querySelector(".play-overlay");let l=!1;n.onload=function(){t++,t===e.length&&setMaxHeight()},o.addEventListener("click",function(){l?(n.classList.remove("playing"),c.classList.remove("hidden"),l=!1):(n.classList.add("playing"),c.classList.add("hidden"),l=!0)})})})</script><div class="bar_top"><ul><li><div style="text-indent:0"><button class="modalButton" style="background-color:transparent;color:#fff;display:block;margin-bottom:-2px"><img src="/julia_book/assets/icons/sheets01.png" style="width:auto;height:30px;opacity:.9;padding-bottom:5px;margin-left:0"> Sections</button></div><div class="modal" id="modal_bar"><div class="modal-content"><div class="modal-header"><h2 style="text-decoration:none"><span style="text-decoration:underline">PART II</span>: HIGH PERFORMANCE</h2></div><div class="modal-body"><div class="row"><div class="column"><div style="padding-bottom:.8em"></div><ul><li>7. <u>Introduction to Performance</u><ul><li><a href="/julia_book/PAGES/07a_overview/"><i>a</i>. Overview and Goals</a></li><br><li><a href="/julia_book/PAGES/07b_introPerformace/"><i>b</i>. When To Optimize Code?</a></li><br><li><a href="/julia_book/PAGES/07c_benchmarks/"><i>c</i>. Benchmarking Execution Time</a></li><br><li><a href="/julia_book/PAGES/07d_TS-onTypes/"><i>d</i>. Preliminaries on Types</a></li><br><li><a href="/julia_book/PAGES/07e_TS-onFunctions/"><i>e</i>. Functions: Type Inference and Multiple Dispatch</a></li><br></ul></li></ul></div><div class="column"><div style="padding-bottom:.8em"></div><ul><li>8. <u>Type Stability</u><ul><li><a href="/julia_book/PAGES/08a_overview/"><i>a</i>. Overview and Goals</a></li><br><li><a href="/julia_book/PAGES/08b_TS-definition/"><i>b</i>. Defining Type Stability</a></li><br><li><a href="/julia_book/PAGES/08c_TS-scalarsVectors/"><i>c</i>. Type Stability with Scalars and Vectors</a></li><br><li><a href="/julia_book/PAGES/08d_TS-globalVariables/"><i>d</i>. Type Stability with Global Variables</a></li><br><li><a href="/julia_book/PAGES/08e_TS-barrierFunctions/"><i>e</i>. Barrier Functions</a></li><br><li><a href="/julia_book/PAGES/08f_TS-tuples/"><i>f</i>. Type Stability with Tuples</a></li><br><li><a href="/julia_book/PAGES/08g_TS-highOrderFunctions/"><i>g</i>. Type Stability with Higher-Order Functions</a></li><br><li><a href="/julia_book/PAGES/08h_TS-gotchas/"><i>h</i>. Gotchas for Type Stability</a></li><br></ul></li></ul></div><div class="column"><div style="padding-bottom:.8em"></div><ul><li>9. <u>Reducing Memory Allocations</u><ul><li><a href="/julia_book/PAGES/09a_overview/"><i>a</i>. Overview and Goals</a></li><br><li><a href="/julia_book/PAGES/09b_onAllocations/"><i>b</i>. Stack vs Heap</a></li><br><li><a href="/julia_book/PAGES/09c_objectsAllocating/"><i>c</i>. Objects Allocating Memory</a></li><br><li><a href="/julia_book/PAGES/09d_views/"><i>d</i>. Slice Views to Decrease Allocations</a></li><br><li><a href="/julia_book/PAGES/09e_preallocations/"><i>e</i>. Pre-Allocations</a></li><br><li><a href="/julia_book/PAGES/09f_reductions/"><i>f</i>. Reductions</a></li><br><li><a href="/julia_book/PAGES/09g_staticVectors/"><i>g</i>. Static Vectors for Small Collections</a></li><br><li><a href="/julia_book/PAGES/09h_lazyOperations/"><i>h</i>. Lazy Operations</a></li><br><li><a href="/julia_book/PAGES/09i_lazyBroadcasting/"><i>i</i>. Lazy Broadcasting and Loop Fusion</a></li><br></ul></li></ul></div></div><div class="row"><div class="column"><div style="padding-bottom:.8em"></div><ul><li>10. <u>Vectorization (SIMD)</u><ul><li><a href="/julia_book/PAGES/10a_overview/"><i>a</i>. Overview and Goals</a></li><br><li><a href="/julia_book/PAGES/10b_macrosAlgorithms/"><i>b</i>. Macros as a Means for Optimizations</a></li><br><li><a href="/julia_book/PAGES/10c_simd_intro/"><i>c</i>. Introduction to SIMD</a></li><br><li><a href="/julia_book/PAGES/10d_simd_independence/"><i>d</i>. SIMD: Independence of Iterations</a></li><br><li><a href="/julia_book/PAGES/10e_simd_unitStrides/"><i>e</i>. SIMD: Contiguous Access and Unit Strides</a></li><br><li><a href="/julia_book/PAGES/10f_simd_branchless/"><i>f</i>. SIMD: Branchless Code</a></li><br><li><a href="/julia_book/PAGES/10g_simd_LoopVectorization/"><i>g</i>. SIMD Packages</a></li><br></ul></li></ul></div><div class="column"><div style="padding-bottom:.8em"></div><ul><li>11. <u>Multithreading</u><ul><li><a href="/julia_book/PAGES/11a_overview/"><i>a</i>. Overview and Goals</a></li><br><li><a href="/julia_book/PAGES/11b_multithread_intro/"><i>b</i>. Introduction to Multithreading</a></li><br><li><a href="/julia_book/PAGES/11c_multithread_tasks/"><i>c</i>. Task-Based Parallelism: @spawn</a></li><br><li><a href="/julia_book/PAGES/11d_multithread_safe/"><i>d</i>. Thread-Safe Operations</a></li><br><li><a href="/julia_book/PAGES/11e_multithread_loops/"><i>e</i>. Parallel For-Loops: @threads</a></li><br><li><a href="/julia_book/PAGES/11f_multithread_apply/"><i>f</i>. Parallelization in Practice</a></li><br><li><a href="/julia_book/PAGES/11g_multithread_packages/"><i>g</i>. Multithreading Packages</a></li><br></ul></li></ul></div><div class="column"><div style="padding-bottom:.8em"></div></div></div></div></div></div></li></ul></div><style>.bar_top{padding-left:160px}.bar_top{background-image:linear-gradient(to right,#000,#000 10%,#3f6388 55%,#3f6388);position:fixed;width:100%;height:48px;top:0;left:0;padding:8px 0 10px 0;font-size:110%;z-index:125;font-family:Inter}.bar_top a:hover{color:#a09f9f}.bar_top>ul{list-style-type:none;float:left;position:relative;bottom:0;padding-left:1%;left:160px}.bar_top li a{color:#fff}.bar_top .modal{background-color:transparent;margin-top:48px;padding-left:1%;margin-left:0;width:100%;height:100%;overflow:auto;position:fixed}.bar_top .modal-content{position:relative;width:1200px;max-width:90%;height:max-content;max-height:90%;background-color:#000;margin:auto;padding:8px;margin-left:160px;-webkit-animation-name:none;animation-name:none}.bar_top .modal-header{background-color:#000;color:#fff}.bar_top .modal-body{color:#649dd6}.bar_top .modal-body .row{display:flex}.bar_top .modal-body .row .column{flex:1}.bar_top .modal-body .row h3{padding-bottom:.5em}.bar_top .modal-body .row ul li{line-height:1}.bar_top .modal-body .row ul li ul{list-style-type:none;margin:0;padding:0;padding-top:.5em;padding-bottom:.4em;line-height:1}.bar_top .modal-body .row ul li ul li{line-height:1}.bar_top .modal-body .row li{line-height:1;list-style-type:none;float:center;text-indent:-20px;padding-left:22px;position:relative}.bar_top .modal-body .row .column{text-align:center}.bar_top .modal-body .row .column h3{text-align:center}.bar_top .modal-body .row .column ul{text-align:left;margin-left:auto;margin-right:auto;list-style-position:inside;line-height:.55em}.bar_top .modalButton{border:none;margin-bottom:24px;box-shadow:none}.bar_top .modalClose{font-size:0px}</style><style>.footn{position:relative;display:inline-block;margin-left:-.6em;margin-right:0;color:#2669dd;text-decoration:underline}.supr{vertical-align:80%;font-size:75%;line-height:1}.footn .footn_text{font-size:125%;visibility:hidden;text-align:justify;text-justify:inter-word;text-indent:0;line-height:1.5;background-color:#282c34;color:#e0e4eb;border-radius:6px;padding:5px 12px 5px 12px;position:absolute;z-index:1;bottom:100%;right:0}.footn .footn_text.left{left:0;width:max-content;max-width:500px}.footn .footn_text.right{right:0;width:max-content;max-width:500px}.footn:hover .footn_text{visibility:visible}.footn a{color:#7b9fdd}.footn a:hover{color:#a1b6dbb2}</style><script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script><script>$(document).ready(function(){$(".footn.supr").hover(function(){var t=$(this).find(".footn_text"),e=$(this).closest("p"),o=e.width(),s=t.offset().left-e.offset().left>o/2;t.removeClass("left right"),s?t.addClass("right"):t.addClass("left"),t.addClass("hovering")},function(){$(this).find(".footn_text").removeClass("hovering"),$(this).find(".footn_text").removeClass("left right")})})</script><style>@media (max-width:768px){.footn .footn_text.left{left:0;width:max-content;max-width:200px}.footn .footn_text.right{right:0;width:max-content;max-width:200px}}</style><style>@media (max-width:850px){.jumbotron{font-size:90%!important}.franklin-content{font-size:100%!important}.franklin-content{padding-left:1%;padding-right:1%}.franklin-content .container{max-width:100%!important}.index_container,.index_container section{font-size:100%}.index_container{padding-left:1%;padding-right:1%}.index_container ul li{padding-right:5%;padding-left:0}.index_container ul{padding-right:0;padding-left:5%}.home_container section{font-size:100%;line-height:1.55em}.home_container ul li{padding-right:1%;padding-left:0}.home_container ul{padding-right:0;padding-left:0}.home_container .row li{padding-left:0;padding-bottom:1.55em;margin-left:0}.home_container .bullets_nomarker ul li p{line-height:1.55!important}.col-lg-.mx-auto{overflow:auto!important}.jumbotron{padding-left:60px!important;padding-right:1%!important;padding-top:0;margin-top:0}.modal{padding:2px!important}.bullets ol,.itemNoSpace ol{padding:4px}.bullets ul li,.itemNoSpace ul li{padding-right:5%;padding-left:0;margin-left:0}.bullets ul li p,.itemNoSpace ul li p{line-height:1.65}}@media (max-height:600px){.jumbotron{font-size:90%!important}.franklin-content{font-size:100%!important}.franklin-content .container{max-width:100%!important}.index_container,.index_container section{font-size:100%}.index_container ul li{padding-right:5%;padding-left:0}.index_container ul{padding-right:0;padding-left:5%}.index_container{padding-left:1%;padding-right:1%}.col-lg-.mx-auto{overflow:auto!important}.jumbotron{padding-left:60px!important;padding-right:1%!important;padding-top:0;margin-top:0}.franklin-content{padding-left:0!important}.modal{padding:2px!important}.bullets ol,.itemNoSpace ol{padding:6px}.bullets ul li,.itemNoSpace ul li{padding-right:5%;padding-left:0;margin-left:0}.bullets ul li p,.itemNoSpace ul li p{line-height:1.55}.index_container ul li{padding-right:5%;padding-left:0}.index_container ul{padding-right:0;padding-left:5%}}</style><div class="left_bar_mobile" style="color:#fff"><ul><li><a href="/julia_book/index.html"><img src="/julia_book/assets/icons/home.png" style="width:15%;height:auto;opacity:.9;padding-bottom:0"> HOME</a></li><li><a href="/julia_book/list_posts/"><img src="/julia_book/assets/icons/books03.png" style="width:15%;height:auto;opacity:.9;padding-bottom:0"> CHAPTERS</a></li><li><div class="dark-mode-mobile"><label class="switch"><input type="checkbox" class="toggleMobile"> <span class="slider round"></span></label></div></li></ul></div><style>@media (min-width:850px),(min-height:600px){.left_bar_mobile{display:none}}@media (max-width:850px),(max-height:600px){.left_bar_mobile{display:block}.left_bar_mobile img{display:none}.left_bar_mobile{z-index:200;background-image:none;position:absolute;font-family:Inter;height:160px!important;top:0;left:0;font-size:85% width : 60px}.left_bar_mobile ul{list-style-type:none;float:left;font-size:100%;position:relative;padding-left:.4em;padding-top:.2em;line-height:2em!important;height:100%;top:0;width:60px;display:flex;flex-direction:column;justify-content:space-around}.left_bar_mobile li{flex:1}.left_bar_mobile li a{color:#fff}.left_bar_mobile a:hover{color:#a09f9f}.dark-mode-mobile{position:relative;bottom:0;margin-top:auto}.dark-mode-mobile .switch{width:40px;height:20px}.dark-mode-mobile .slider:before{height:15px;width:15px}.dark-mode-mobile input:checked+.slider:before{transform:translateX(20px)}@media (max-width:850px),(max-height:600px){h2{font-size:140%;padding-top:1em}h1{font-size:180%;padding-top:.5em;padding-bottom:0}}}</style><style>@media (max-width:850px),(max-height:600px){.lead{display:none}.bar_top,.copy-button,.py-1 .container .center-text,nav{display:none!important}.jumbotron{padding-left:80px;padding-right:.1%!important;padding-top:0;margin-top:0}}</style><style>@media (min-width:850px),(min-height:600px){.dark-mode-mobile{visibility:hidden}}@media (max-width:850px),(max-height:600px){.dark-mode-mobile{visibility:visible}}</style><script>document.querySelector(".toggleMobile").addEventListener("change",function(){const e=document.documentElement;this.checked?(e.classList.add("dark-mode"),localStorage.setItem("darkMode","enabled")):(e.classList.remove("dark-mode"),localStorage.setItem("darkMode","disabled"))}),window.addEventListener("load",function(){const e=document.documentElement;"enabled"===localStorage.getItem("darkMode")?(document.querySelector(".toggleMobile").checked=!0,e.classList.add("dark-mode")):document.querySelector(".toggleMobile").checked=!1})</script><div class="franklin-content"><section id="branches" class="scrollspy section-bg-color"><div class="container"><div class="row"><div class="col-lg- mx-auto"><h2>Branches</h2><p></p><p>SIMD accelerates computations by executing the same set of instructions in parallel across multiple data elements. Yet, certain programming constructs, particularly conditional statements, can severely degrade SIMD efficiency. The issue arises because conditional statements inherently lead to different instruction paths, thus disrupting the single instruction execution that SIMD relies on. While the compiler attempts to mitigate this issue by transforming code into SIMD-compatible forms, these adaptations often incur a performance penalty.</p><p>This section explores strategies for efficiently applying SIMD in the presence of conditional operations. We&#39;ll first examine scenarios where the compiler introduces conditional statements as an artifact of its internal computation techniques. By employing alternative coding strategies, we&#39;ll show how these conditional statements can be bypassed.</p><p>After this, we&#39;ll explore conditional statements that are intrinsic to program logic and therefore unavoidable. This includes the standard scenario where conditions are explicitly introduced in the code. In this respect, we&#39;ll revisit the usual approaches to expressing conditions, focusing on their internal implementation. We&#39;ll outline their relative strengths and limitations, indicating which approaches are more conducive to SIMD optimizations. Finally, we&#39;ll show that conditional statements can be equivalently recast as algebraic operations, which effectively removes the branching logic that disrupts SIMD execution.</p><p></p></div></div></div></section><section id="type_stability_and_bounds_checking_as_avoidable_conditions" class="scrollspy"><div class="container"><div class="row"><div class="col-lg- mx-auto"><h2>Type Stability and Bounds Checking as Avoidable Conditions</h2><p></p><p>Two patterns in Julia introduce hidden branches that hurt SIMD performance: typeâ€‘unstable functions and bounds checking in array indexing. These conditions arise internally from compiler decisions, rather than explicit code, making them easy to overlook.</p><p>When a function is type-unstable, Julia generates multiple execution branches, one for each type. Those extra branches, while invisible to you, still disrupt the uniform instruction flow required by SIMD. The remedies for this case are the same as those for fixing type instabilities. Regardless of any SIMD consideration, recall that you should always strive for type stability. Type instability is a major performance bottleneck, with any attempt to achieve high performance becoming nearly impossible without addressing it.</p><p>The other source of hidden conditionals arises in for-loops, which perform bounds checking by default. This operation represents a subtle form of conditional execution, where each iteration is executed only when indices remain within bounds.</p><p>In relation to this scenario, the example below demonstrates two key insights. First, merely adding <code>@inbounds</code> can be enough to induce the compiler to apply SIMD instructions, rendering <code>@simd</code> annotations redundant for performance improvements. This explains why using <code>@inbounds @simd</code> in the example has a negligible impact on execution times. <span class="footn supr">&#91;note&#93; <span class="footn_text">Recall that the compiler may automatically disable bounds checking in some cases, especially in straightforward cases. For instance, this would be the case in our example if only <code>x</code> had been indexed and <code>eachindex&#40;x&#41;</code> were employed as the iteration range. This is in contrast to scenarios like the one below, where we&#39;re indexing both <code>x</code> and <code>output</code>. </span></span>Second, the example highlights that <strong>adding `@inbounds` is a necessary precondition for the application of SIMD</strong>. Simply using <code>@simd</code> on its own won&#39;t trigger the implementation of SIMD instructions, as the compiler may still be hindered by the bounds checks. Overall, if we aim to apply SIMD in a for-loop, we should prepend it with <code>@inbounds @simd</code>.</p><div class="hide_tab"><details open><summary><div class="closed_text"></div></summary><p></p><div class="tab_wrapper"><div class="tab_code_links"><button class="tablink first_tab active" data-id="">No Macros</button> <button class="tablink" data-id="">@simd</button> <button class="tablink" data-id="">@inbounds</button> <button class="tablink" data-id="">@inbounds + @simd</button></div><div data-id="" class="tabcontent active"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output &#61; similar&#40;x&#41;

    for i in eachindex&#40;x&#41;
        output&#91;i&#93; &#61; 2/x&#91;i&#93;
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>@btime foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  775.469 Î¼s (2 allocations: 7.629 MiB)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output &#61; similar&#40;x&#41;

    @simd for i in eachindex&#40;x&#41;
        output&#91;i&#93; &#61; 2/x&#91;i&#93;
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>@btime foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  792.687 Î¼s (2 allocations: 7.629 MiB)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output &#61; similar&#40;x&#41;

    @inbounds for i in eachindex&#40;x&#41;
        output&#91;i&#93; &#61; 2/x&#91;i&#93;
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>@btime foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  474.154 Î¼s (2 allocations: 7.629 MiB)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output &#61; similar&#40;x&#41;

    @inbounds @simd for i in eachindex&#40;x&#41;
        output&#91;i&#93; &#61; 2/x&#91;i&#93;
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>@btime foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  452.921 Î¼s (2 allocations: 7.629 MiB)
</code></pre></div></div></div></div></div><p></p></details></div><div class="note"><div class="title"><span class="note_title" style="font-weight:500"><img src="/julia_book/assets/icons/exclamation.png" style="width:auto;height:30px;opacity:.99;padding-bottom:4px;margin-left:-4px;padding-right:.4em"><strong>Broadcasting and For-Loops</strong></span></div><div class="content">Broadcasting disables bounds checking and strongly favors SIMD by default, often making it appear more performant than a simple for-loop. Despite this, broadcasting essentially serves as a concise notation for implementing a for-loop. As the example below demonstrates, a for-loop that has been optimized with <code>@inbounds</code> and <code>@simd</code> will typically exhibit a similar level of performance to a broadcasted operation.<p></p><p></p><div class="hide_tab"><details open><summary><div class="closed_text"></div></summary><p></p><div class="tab_wrapper"><div class="tab_code_links"><button class="tablink first_tab active" data-id="">Broadcasting</button> <button class="tablink" data-id="">For-Loop (With Macros)</button> <button class="tablink" data-id="">For-Loop (No Macros)</button></div><div data-id="" class="tabcontent active"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x      &#61; rand&#40;1_000_000&#41;
foo&#40;x&#41; &#61; 2 ./ x</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>@btime foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  431.487 Î¼s (2 allocations: 7.629 MiB)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x      &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output &#61; similar&#40;x&#41;

    @inbounds @simd for i in eachindex&#40;x&#41;
        output&#91;i&#93; &#61; 2/x&#91;i&#93;
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>@btime foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  435.973 Î¼s (2 allocations: 7.629 MiB)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x      &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output &#61; similar&#40;x&#41;

    for i in eachindex&#40;x&#41;
        output&#91;i&#93; &#61; 2/x&#91;i&#93;
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>@btime foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  809.359 Î¼s (2 allocations: 7.629 MiB)
</code></pre></div></div></div></div></div><p></p></details></div></div></div><p></p></div></div></div></section><section id="approaches_to_conditional_statements" class="scrollspy section-bg-color"><div class="container"><div class="row"><div class="col-lg- mx-auto"><h2>Approaches to Conditional Statements</h2><p></p><p>When conditions are part of the program&#39;s logical flow and therefore unavoidable, we need to inquire on what approach is better for the introduction.</p><p>Specifically, conditional statements can be evaluated either eagerly or lazily. To illustrate, let&#39;s consider the computation of <code>1 &#43; 1</code> but only if certain condition <code>C</code> is met. A lazy approach evaluates whether <code>C</code> holds true, before proceeding with the computation of <code>1 &#43; 1</code>. Thus, the operation is deferred until it&#39;s confirmed that <code>C</code> holds. In contrast, an eager approach computes <code>1 &#43; 1</code>, regardless of whether <code>C</code> is satisfied. If <code>C</code> turns out to be false, the computation remains unused.</p><p>When conditional statements are applied only once, a lazy approach is almost always more performant as it avoids needless computations. However, inside a for-loop, SIMD can compute multiple operations simultaneously. Consequently, it may be beneficial to evaluate all conditions and branches upfront, selecting the relevant branches afterward. The possibility is especially true when branches involve inexpensive computations.</p><p>In Julia, whether a conditional statement is evaluated lazily or eagerly depends on how it&#39;s written. Next, we explore this nuance in more detail.</p><p></p></div></div></div></section><section id="ifelse_vs_if" class="scrollspy"><div class="container"><div class="row"><div class="col-lg- mx-auto"><h2>ifelse vs if</h2><p></p><p>The <code>ifelse</code> function in Julia follows an eager evaluation strategy, where both the condition and possible outcomes are computed before deciding which result to return. In contrast, <code>if</code> and <code>&amp;&amp;</code> favor lazy computations, only evaluating the necessary components based on the truth value of the condition.</p><p>The following example demonstrates this computational difference through a reduction operation that&#39;s contingent on a condition. <span class="footn supr">&#91;note&#93; <span class="footn_text">Note that <code>ifelse</code> requires specifying an operation for when the condition is true and another when it&#39;s not. For a sum reduction, this is handled by returning zero when the condition isn&#39;t met.</span></span></p><div class="hide_tab"><details open><summary><div class="closed_text"></div></summary><p></p><div class="tab_wrapper"><div class="tab_code_links"><button class="tablink first_tab active" data-id="">if</button> <button class="tablink" data-id="">if + @simd</button> <button class="tablink" data-id="">ifelse</button> <button class="tablink" data-id="">ifelse + @simd</button></div><div data-id="" class="tabcontent active"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output &#61; 0.0

    for i in eachindex&#40;x&#41;
        if x&#91;i&#93; &gt; 0.5
            output &#43;&#61; x&#91;i&#93;/2
        end
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>@btime foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  415.373 Î¼s (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        if x&#91;i&#93; &gt; 0.5
            output &#43;&#61; x&#91;i&#93;/2
        end
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>@btime foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  414.155 Î¼s (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output &#61; 0.0

    for i in eachindex&#40;x&#41;
        output &#43;&#61; ifelse&#40;x&#91;i&#93; &gt; 0.5, x&#91;i&#93;/2, 0&#41;
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>@btime foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  393.046 Î¼s (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        output &#43;&#61; ifelse&#40;x&#91;i&#93; &gt; 0.5, x&#91;i&#93;/2, 0&#41;
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>@btime foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  87.192 Î¼s (0 allocations: 0 bytes)
</code></pre></div></div></div></div></div><p></p></details></div><p>As the example reveals, an eager computation doesn&#39;t automatically imply the application of SIMD. This is precisely why the macro <code>@simd</code> is included, which provides a hint to the compiler that vectorizing the operation might be beneficial. In fact, we&#39;ll show later that adding <code>@simd</code> when conditions comprise multiple statements could prompt the compiler to vectorize conditions, while still relying on a lazy evaluation.</p><p>It&#39;s also worth remarking that applying SIMD instructions doesn&#39;t necessarily increase performance. The example below demonstrates this point, where the compiler adopts a SIMD approach with <code>ifelse</code>.</p><div class="hide_tab"><details open><summary><div class="closed_text"></div></summary><p></p><div class="tab_wrapper"><div class="tab_code_links"><button class="tablink first_tab active" data-id="">ifelse</button> <button class="tablink" data-id="">ifelse + @inbounds</button> <button class="tablink" data-id="">ifelse + @inbounds + @simd</button></div><div data-id="" class="tabcontent active"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x      &#61; rand&#40;5_000_000&#41;
output &#61; similar&#40;x&#41;

function foo&#33;&#40;output,x&#41;
    for i in eachindex&#40;x&#41;
        output&#91;i&#93; &#61; ifelse&#40;x&#91;i&#93; &gt; 0.5, x&#91;i&#93;/2, 0&#41;
    end
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  2.806 ms (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x      &#61; rand&#40;5_000_000&#41;
output &#61; similar&#40;x&#41;

function foo&#33;&#40;output,x&#41;
    @inbounds for i in eachindex&#40;x&#41;
        output&#91;i&#93; &#61; ifelse&#40;x&#91;i&#93; &gt; 0.5, x&#91;i&#93;/2, 0&#41;
    end
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  2.888 ms (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x      &#61; rand&#40;5_000_000&#41;
output &#61; similar&#40;x&#41;

function foo&#33;&#40;output,x&#41;
    @inbounds @simd for i in eachindex&#40;x&#41;
        output&#91;i&#93; &#61; ifelse&#40;x&#91;i&#93; &gt; 0.5, x&#91;i&#93;/2, 0&#41;
    end
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  16.026 ms (0 allocations: 0 bytes)
</code></pre></div></div></div></div></div><p></p></details></div><p></p></div></div></div></section><section id="ternary_operators" class="scrollspy section-bg-color"><div class="container"><div class="row"><div class="col-lg- mx-auto"><h2>Ternary Operators</h2><p></p><p>Ternary operators are an alternative approach for conditional statements, consisting of the form <code>&lt;condition&gt; ? &lt;action if true&gt; : &lt;action if false&gt;</code>. Unlike the previous methods, this form relies on heuristics to determine whether an eager or lazy approach should be used. The decision depends on which strategy would more likely be faster in the application considered.</p><p>For the illustrations, we&#39;ll consider examples where we directly add <code>@inbounds</code> and <code>@simd</code> in each approach.</p><h4>Different Choices</h4><p>Starting with the same example as above, we show that the ternary operator could choose an eager approach.</p><div class="hide_tab"><details open><summary><div class="closed_text"></div></summary><p></p><div class="tab_wrapper"><div class="tab_code_links"><button class="tablink first_tab active" data-id="">if</button> <button class="tablink" data-id="">ifelse</button> <button class="tablink" data-id="">Ternary</button></div><div data-id="" class="tabcontent active"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        if x&#91;i&#93; &gt; 0.5
            output &#43;&#61; x&#91;i&#93;/2
        end
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  422.480 Î¼s (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        output &#43;&#61; ifelse&#40;x&#91;i&#93;&gt;0.5, x&#91;i&#93;/2, 0&#41;
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  85.895 Î¼s (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        output &#43;&#61; x&#91;i&#93;&gt;0.5 ? x&#91;i&#93;/2 : 0
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  87.881 Î¼s (0 allocations: 0 bytes)
</code></pre></div></div></div></div></div><p></p></details></div><p>Instead, the ternary operator opts for a lazy approach in the following example.</p><div class="hide_tab"><details open><summary><div class="closed_text"></div></summary><p></p><div class="tab_wrapper"><div class="tab_code_links"><button class="tablink first_tab active" data-id="">if</button> <button class="tablink" data-id="">ifelse</button> <button class="tablink" data-id="">Ternary</button></div><div data-id="" class="tabcontent active"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        if x&#91;i&#93; &gt; 0.99
            output &#43;&#61; log&#40;x&#91;i&#93;&#41;
        end
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  405.304 Î¼s (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        output &#43;&#61; ifelse&#40;x&#91;i&#93; &gt; 0.99, log&#40;x&#91;i&#93;&#41;, 0&#41;
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  3.470 ms (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        output &#43;&#61; x&#91;i&#93;&gt;0.99 ? log&#40;x&#91;i&#93;&#41; : 0
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  421.493 Î¼s (0 allocations: 0 bytes)
</code></pre></div></div></div></div></div><p></p></details></div><h4>Ternary Operator Could Choose A Less Performant Approach</h4><p>It&#39;s worth remarking that the method chosen by the ternary operator isn&#39;t foolproof. In the following example, the ternary operator actually implements the slowest approach.</p><div class="hide_tab"><details open><summary><div class="closed_text"></div></summary><p></p><div class="tab_wrapper"><div class="tab_code_links"><button class="tablink first_tab active" data-id="">if</button> <button class="tablink" data-id="">ifelse</button> <button class="tablink" data-id="">Ternary</button></div><div data-id="" class="tabcontent active"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x      &#61; rand&#40;5_000_000&#41;
output &#61; similar&#40;x&#41;

function foo&#33;&#40;output,x&#41;
    @inbounds @simd for i in eachindex&#40;x&#41;
        if x&#91;i&#93; &gt; 0.5
            output&#91;i&#93; &#61; log&#40;x&#91;i&#93;&#41;
        end
    end
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  26.620 ms (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x      &#61; rand&#40;5_000_000&#41;
output &#61; similar&#40;x&#41;

function foo&#33;&#40;output,x&#41;
    @inbounds @simd for i in eachindex&#40;x&#41;
        output&#91;i&#93; &#61; ifelse&#40;x&#91;i&#93; &gt; 0.5, log&#40;x&#91;i&#93;&#41;, 0&#41;
    end
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  16.864 ms (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x      &#61; rand&#40;5_000_000&#41;
output &#61; similar&#40;x&#41;

function foo&#33;&#40;output,x&#41;
    @inbounds @simd for i in eachindex&#40;x&#41;
        output&#91;i&#93; &#61; x&#91;i&#93;&gt;0.5 ? log&#40;x&#91;i&#93;&#41; : 0
    end
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  26.517 ms (0 allocations: 0 bytes)
</code></pre></div></div></div></div></div><p></p></details></div><p></p></div></div></div></section><section id="scenarios_under_which_each_approach_is_better" class="scrollspy"><div class="container"><div class="row"><div class="col-lg- mx-auto"><h2>Scenarios Under Which Each Approach is Better</h2><p></p><p>As a rule of thumb, <strong>an eager approach is potentially more performant when branches comprise simple algebraic computations</strong>. On the contrary, conditional statements with <strong>computational-demanding operations will more likely benefit from a lazy implementation</strong>. In fact, this is a heuristic commonly followed by ternary operators.</p><p>To demonstrate this, the following example considers a conditional statement where only one branch has a computation, which in turn is straightforward. An eager approach with SIMD is faster, and coincides with the approach chosen when a ternary operator is chosen.</p><div class="hide_tab"><details open><summary><div class="closed_text"></div></summary><p></p><div class="tab_wrapper"><div class="tab_code_links"><button class="tablink first_tab active" data-id="">if</button> <button class="tablink" data-id="">ifelse</button> <button class="tablink" data-id="">Ternary</button></div><div data-id="" class="tabcontent active"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x              &#61; rand&#40;1_000_000&#41;
condition&#40;a&#41;   &#61; a &gt; 0.5
computation&#40;a&#41; &#61; a * 2

function foo&#40;x&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        if condition&#40;x&#91;i&#93;&#41;
            output &#43;&#61; computation&#40;x&#91;i&#93;&#41;
        end
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  416.681 Î¼s (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x              &#61; rand&#40;1_000_000&#41;
condition&#40;a&#41;   &#61; a &gt; 0.5
computation&#40;a&#41; &#61; a * 2

function foo&#40;x&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        output &#43;&#61; ifelse&#40;condition&#40;x&#91;i&#93;&#41;, computation&#40;x&#91;i&#93;&#41;, 0&#41;
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  86.242 Î¼s (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x              &#61; rand&#40;1_000_000&#41;
condition&#40;a&#41;   &#61; a &gt; 0.5
computation&#40;a&#41; &#61; a * 2

function foo&#40;x&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        output &#43;&#61; condition&#40;x&#91;i&#93;&#41; ? computation&#40;x&#91;i&#93;&#41; : 0
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  86.370 Î¼s (0 allocations: 0 bytes)
</code></pre></div></div></div></div></div><p></p></details></div><p>Instead, the following scenario considers a branch with more computational-intensive calculations. In this case, a lazy approach is faster, which is the approach implemented by the ternary operator.</p><div class="hide_tab"><details open><summary><div class="closed_text"></div></summary><p></p><div class="tab_wrapper"><div class="tab_code_links"><button class="tablink first_tab active" data-id="">if</button> <button class="tablink" data-id="">ifelse</button> <button class="tablink" data-id="">Ternary</button></div><div data-id="" class="tabcontent active"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x              &#61; rand&#40;2_000_000&#41;
condition&#40;a&#41;   &#61; a &gt; 0.5
computation&#40;a&#41; &#61; exp&#40;a&#41;/3 - log&#40;a&#41;/2

function foo&#40;x&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        if condition&#40;x&#91;i&#93;&#41;
            output &#43;&#61; computation&#40;x&#91;i&#93;&#41;
        end
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  12.346 ms (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x              &#61; rand&#40;2_000_000&#41;
condition&#40;a&#41;   &#61; a &gt; 0.5
computation&#40;a&#41; &#61; exp&#40;a&#41;/3 - log&#40;a&#41;/2

function foo&#40;x&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        output &#43;&#61; ifelse&#40;condition&#40;x&#91;i&#93;&#41;, computation&#40;x&#91;i&#93;&#41;, 0&#41;
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  16.552 ms (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x              &#61; rand&#40;2_000_000&#41;
condition&#40;a&#41;   &#61; a &gt; 0.5
computation&#40;a&#41; &#61; exp&#40;a&#41;/3 - log&#40;a&#41;/2

function foo&#40;x&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        output &#43;&#61; condition&#40;x&#91;i&#93;&#41; ? computation&#40;x&#91;i&#93;&#41; : 0
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#33;&#40;&#36;output,&#36;x&#41;</code><br><pre><code class="plaintext code-output">  12.492 ms (0 allocations: 0 bytes)
</code></pre></div></div></div></div></div><p></p></details></div><p></p></div></div></div></section><section id="vector_of_conditions" class="scrollspy section-bg-color"><div class="container"><div class="row"><div class="col-lg- mx-auto"><h2>Vector of Conditions</h2><p></p><p>Next, we consider scenarios where you already have a vector holding conditions. This could occur either because the vector is already part of your dataset, or because the conditions will be reused multiple times over your code, in which case storing the conditions is worthy.</p><p>Storing conditions in a vector could be done through an object with type <code>Vector&#123;Bool&#125;</code> or <code>BitVector</code>. The latter is the default type returned by Julia, as when you define objects like <code>x .&gt; 0</code>. Although this type offers certain performance advantages, it can also hinder the application of SIMD. In cases like this, transforming <code>BitVector</code> to <code>Vector&#123;Bool&#125;</code> could speed up computations.</p><p>The following example demonstrates this, where the execution time is faster even considering the vector transformation.</p><div class="hide_tab"><details open><summary><div class="closed_text"></div></summary><p></p><div class="tab_wrapper"><div class="tab_code_links"><button class="tablink first_tab active" data-id="">BitVector</button> <button class="tablink" data-id="">Vector{Bool}</button></div><div data-id="" class="tabcontent active"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x         &#61; rand&#40;1_000_000&#41;
bitvector &#61; x .&gt; 0.5

function foo&#40;x,bitvector&#41;
    output     &#61; similar&#40;x&#41;
        

    @inbounds @simd for i in eachindex&#40;x&#41;
        output&#91;i&#93; &#61; ifelse&#40;bitvector&#91;i&#93;, x&#91;i&#93;/i, x&#91;i&#93;*i&#41;
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#40;&#36;x,&#36;bitvector&#41;</code><br><pre><code class="plaintext code-output">  3.393 ms (2 allocations: 7.629 MiB)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x         &#61; rand&#40;1_000_000&#41;
bitvector &#61; x .&gt; 0.5

function foo&#40;x,bitvector&#41;
    output     &#61; similar&#40;x&#41;
    boolvector &#61; Vector&#40;bitvector&#41;
    
    @inbounds @simd for i in eachindex&#40;x&#41;
        output&#91;i&#93; &#61; ifelse&#40;boolvector&#91;i&#93;, x&#91;i&#93;/i, x&#91;i&#93;*i&#41;
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#40;&#36;x,&#36;bitvector&#41;</code><br><pre><code class="plaintext code-output">  862.798 Î¼s (4 allocations: 8.583 MiB)
</code></pre></div></div></div></div></div><p></p></details></div><div class="note"><div class="title"><span class="note_title" style="font-weight:500"><img src="/julia_book/assets/icons/exclamation.png" style="width:auto;height:30px;opacity:.99;padding-bottom:4px;margin-left:-4px;padding-right:.4em"><strong>No Vector of Conditions</strong></span></div><div class="content">The conclusions stated here assumes that you already have the vector holding the conditions. If this isn&#39;t the case and you want to apply SIMD instructions, you should implement <code>ifelse</code> without a vector of conditions. This allows you to avoid memory allocations, while still applying SIMD effectively. The following example illustrates this point. <span class="footn supr">&#91;note&#93; <span class="footn_text">Note that the approach for <code>Vector&#123;Bool&#125;</code> is somewhat different to the examples we considered above. As we don&#39;t have a vector of conditions already defined, it&#39;s optimal to create <code>Vector&#123;Bool&#125;</code> directly, rather than defining it as a transformation of the <code>BitVector</code>. In this way, we avoid unnecessary memory allocations too.</span></span><p></p><p></p><div class="hide_tab"><details open><summary><div class="closed_text"></div></summary><p></p><div class="tab_wrapper"><div class="tab_code_links"><button class="tablink first_tab active" data-id="">BitVector</button> <button class="tablink" data-id="">Vector{Bool}</button> <button class="tablink" data-id="">No Vector</button></div><div data-id="" class="tabcontent active"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output     &#61; similar&#40;x&#41;
    bitvector  &#61; x .&gt; 0.5
    
    
    @inbounds @simd for i in eachindex&#40;x&#41;
        output&#91;i&#93; &#61; ifelse&#40;bitvector&#91;i&#93;, x&#91;i&#93;/i, x&#91;i&#93;*i&#41;
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  3.628 ms (6 allocations: 7.753 MiB)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output     &#61; similar&#40;x&#41;
    boolvector &#61; Vector&#123;Bool&#125;&#40;undef,length&#40;x&#41;&#41;
        boolvector .&#61; x .&gt; 0.5

    @inbounds @simd for i in eachindex&#40;x&#41;
        output&#91;i&#93; &#61; ifelse&#40;boolvector&#91;i&#93;, x&#91;i&#93;/i, x&#91;i&#93;*i&#41;
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  774.952 Î¼s (4 allocations: 8.583 MiB)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x &#61; rand&#40;1_000_000&#41;

function foo&#40;x&#41;
    output     &#61; similar&#40;x&#41;
    
    

    @inbounds @simd for i in eachindex&#40;x&#41;
        output&#91;i&#93; &#61; ifelse&#40;x&#91;i&#93;&gt;0.5, x&#91;i&#93;/i, x&#91;i&#93;*i&#41;
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  501.114 Î¼s (2 allocations: 7.629 MiB)
</code></pre></div></div></div></div></div><p></p></details></div></div></div><p></p></div></div></div></section><section id="algebraic_operations_as_compound_conditions" class="scrollspy"><div class="container"><div class="row"><div class="col-lg- mx-auto"><h2>Algebraic Operations as Compound Conditions</h2><p></p><p>We leverage algebraic equivalences to express conditions in ways that allow us to avoid the creation of branches. Mathematically, given a set \(\left\{ b_{i}\right\} _{i=1}^{n}\) where \(b_{i}\in\left\{ 0,1\right\}\):</p><ul><li><p>all conditions are satisfied when</p></li></ul><div class="nonumber">\[ \prod_{i=1}^{n}c_{i} = 1 \]</div><ul><li><p>at least one condition is satisfied when</p></li></ul><div class="nonumber">\[ 1-\prod_{i=1}^{n}(1-c_{i}) = 1 \]</div><p>In terms of Julia, given two Boolean scalars <code>c1</code> and <code>c2</code>, these equivalences become:</p><ul><li><p><code>c1 &amp;&amp; c2</code> is <code>Bool&#40;c1 * c2&#41;</code></p></li><li><p><code>c1 || c2</code> is <code>Bool&#40;1 - &#33;c1 * &#33;c2&#41;</code></p></li></ul><p>For instance, with for-loops:</p><div class="hide_tab"><details open><summary><div class="closed_text"></div></summary><p></p><div class="tab_wrapper"><div class="tab_code_links"><button class="tablink first_tab active" data-id="">&&</button> <button class="tablink" data-id="">Algebraic &&</button> <button class="tablink" data-id="">||</button> <button class="tablink" data-id="">Algebraic ||</button></div><div data-id="" class="tabcontent active"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x                 &#61; rand&#40;1_000_000&#41;
y                 &#61; rand&#40;1_000_000&#41;


function foo&#40;x,y&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        if &#40;x&#91;i&#93; &gt; 0.3&#41; &amp;&amp; &#40;y&#91;i&#93; &lt; 0.6&#41; &amp;&amp; &#40;x&#91;i&#93; &gt; y&#91;i&#93;&#41;
            output &#43;&#61; x&#91;i&#93;
        end       
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  2.116 ms (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x                 &#61; rand&#40;1_000_000&#41;
y                 &#61; rand&#40;1_000_000&#41;


function foo&#40;x,y&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        if &#40;x&#91;i&#93; &gt; 0.3&#41;  * &#40;y&#91;i&#93; &lt; 0.6&#41;  * &#40;x&#91;i&#93; &gt; y&#91;i&#93;&#41;
            output &#43;&#61; x&#91;i&#93;
        end       
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  905.078 Î¼s (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x                 &#61; rand&#40;1_000_000&#41;
y                 &#61; rand&#40;1_000_000&#41;


function foo&#40;x,y&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        if &#40;x&#91;i&#93; &gt; 0.3&#41; || &#40;y&#91;i&#93; &lt; 0.6&#41; || &#40;x&#91;i&#93; &gt; y&#91;i&#93;&#41;
            output &#43;&#61; x&#91;i&#93;
        end       
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  2.724 ms (0 allocations: 0 bytes)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x                 &#61; rand&#40;1_000_000&#41;
y                 &#61; rand&#40;1_000_000&#41;


function foo&#40;x,y&#41;
    output &#61; 0.0

    @inbounds @simd for i in eachindex&#40;x&#41;
        if Bool&#40;1 - &#33;&#40;x&#91;i&#93; &gt; 0.3&#41;  * &#33;&#40;y&#91;i&#93; &lt; 0.6&#41;  * &#33;&#40;x&#91;i&#93; &gt; y&#91;i&#93;&#41;&#41;
            output &#43;&#61; x&#91;i&#93;
        end       
    end

    return output
end</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  889.879 Î¼s (0 allocations: 0 bytes)
</code></pre></div></div></div></div></div><p></p></details></div><p></p><p>While with broadcasting:</p><div class="hide_tab"><details open><summary><div class="closed_text"></div></summary><p></p><div class="tab_wrapper"><div class="tab_code_links"><button class="tablink first_tab active" data-id="">&&</button> <button class="tablink" data-id="">Algebraic &&</button> <button class="tablink" data-id="">||</button> <button class="tablink" data-id="">Algebraic ||</button></div><div data-id="" class="tabcontent active"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x              &#61; rand&#40;1_000_000&#41;
y              &#61; rand&#40;1_000_000&#41;


foo&#40;x,y&#41;       &#61; @. ifelse&#40;&#40;x&gt;0.3&#41; &amp;&amp; &#40;y&lt;0.6&#41; &amp;&amp; &#40;x&gt;y&#41;, x,y&#41;</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  5.356 ms (2 allocations: 7.629 MiB)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x              &#61; rand&#40;1_000_000&#41;
y              &#61; rand&#40;1_000_000&#41;


foo&#40;x,y&#41;       &#61; @. ifelse&#40;&#40;x&gt;0.3&#41; *  &#40;y&lt;0.6&#41; *  &#40;x&gt;y&#41;, x,y&#41;</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  541.621 Î¼s (2 allocations: 7.629 MiB)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x              &#61; rand&#40;1_000_000&#41;
y              &#61; rand&#40;1_000_000&#41;


foo&#40;x,y&#41;       &#61; @. ifelse&#40;&#40;x&gt;0.3&#41; || &#40;y&lt;0.6&#41; || &#40;x&gt;y&#41;, x,y&#41;</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  3.354 ms (2 allocations: 7.629 MiB)
</code></pre></div></div></div></div><div data-id="" class="tabcontent"><div class="code_in_modal"><div class="code_NoFormat"><pre><code class="language-julia">x              &#61; rand&#40;1_000_000&#41;
y              &#61; rand&#40;1_000_000&#41;


foo&#40;x,y&#41;       &#61; @. ifelse&#40;Bool&#40;1 - &#33;&#40;x&gt;0.3&#41; * &#33;&#40;y&lt;0.6&#41; * &#33;&#40;x&gt;y&#41;&#41;, x,y&#41;</code></pre></div></div><div class="output_in_modal"><div class="sign_output">Output in REPL</div><div class="mixed_output_inline"><div class="mixed_output_NoFormat"><div class="julia_line">julia&gt</div><code>foo&#40;&#36;x&#41;</code><br><pre><code class="plaintext code-output">  536.276 Î¼s (2 allocations: 7.629 MiB)
</code></pre></div></div></div></div></div><p></p></details></div><p></p></div></div></div></section><footer class="py-1"><div class="container"><span class="left-text"><a href="/julia_book/PAGES/10e_simd_unitStrides" class="prevPage"><img src="/julia_book/assets/icons/prev-page.png" style="width:50px;height:auto;opacity:.9;padding-bottom:5px"> Previous Section <span class="ctrl-text">( <kbd>Ctrl + <img src="/julia_book/assets/icons/arrow_left.png" style="width:15px;height:auto;opacity:.9;padding-bottom:2px"> </kbd>)</span> </a></span><span class="right-text"><a href="/julia_book/PAGES/10g_simd_LoopVectorization" class="nextPage">Next Section <span class="ctrl-text">( <kbd>Ctrl + <img src="/julia_book/assets/icons/arrow_right.png" style="width:15px;height:auto;opacity:.9;padding-bottom:2px"> </kbd>)</span> <img src="/julia_book/assets/icons/next-page.png" style="width:50px;height:auto;opacity:.9;padding-bottom:5px"> </a></span><span class="center-text">Â© Martin Alfaro<br>Last Modified October 4, 2025</span></div></footer><style>@media (max-width:850px),(max-height:600px){.ctrl-text{display:none}}footer{font-family:Inter}footer .container{width:100%;margin-top:.6em;margin-bottom:.5em;overflow:hidden;text-align:center;align-items:center;justify-content:center;color:#fff}footer .center-text{text-align:center}footer .left-text{float:left}footer .right-text{float:right}footer a{color:#fff}footer a:hover{color:#fff;opacity:.9;text-decoration:none}</style><script>const prevPageURL=document.querySelector(".prevPage").href,nextPageURL=document.querySelector(".nextPage").href;function goToPrevPage(){window.location=prevPageURL}function goToNextPage(){window.location=nextPageURL}document.querySelector(".prevPage").addEventListener("click",goToPrevPage),document.querySelector(".nextPage").addEventListener("click",goToNextPage),document.addEventListener("keyup",e=>{"ArrowLeft"===e.key&&e.ctrlKey?goToPrevPage():"ArrowRight"===e.key&&e.ctrlKey&&goToNextPage()})</script></div><script src="/julia_book/libs/katex/katex.min.js"></script><script src="/julia_book/libs/katex/auto-render.min.js"></script><script>renderMathInElement(document.body)</script><script src="/julia_book/libs/highlight/highlight.js"></script><script>hljs.highlightAll(),hljs.configure({tabReplace:"    "})</script><script src="/julia_book/libs/simple-scrollspy.min.js"></script><script>window.onload=function(){scrollSpy("#navbarResponsive",{sectionClass:".scrollspy",menuActiveTarget:".nav-link",offset:100})}</script></body></html><!-- 
#################################################
# FOR ALL PAGES
################################################# 
--><script>const btns=document.getElementsByClassName("modalButton"),modals=document.getElementsByClassName("modal");[...btns].forEach((e,t)=>{e.onclick=()=>{"block"===modals[t].style.display?modals[t].style.display="none":modals[t].style.display="block"}}),window.addEventListener("click",function(e){const t=document.getElementsByClassName("modal"),l=document.getElementsByClassName("modal-content"),n=document.getElementsByClassName("modalButton");for(let s=0;s<t.length;s++){const o=t[s],a=l[s],d=n[s];"block"!==o.style.display||a.contains(e.target)||d.contains(e.target)||(o.style.display="none")}}),document.addEventListener("keydown",function(e){if(e.ctrlKey&&"z"===e.key){const e=document.getElementById("modal_bar");e&&"block"===e.style.display?e.style.display="none":e.style.display="block"}})</script><script>let handleClick=e=>{Array.from(e.target.parentElement.parentElement.querySelectorAll(".active"),e=>e.classList.remove("active")),e.target.classList.add("active"),document.querySelector(`div.tabcontent[data-id*="${e.target.dataset.id}"]`).classList.add("active")};Array.from(document.getElementsByClassName("tablink"),e=>e.addEventListener("click",handleClick,!1))</script><script>let setHeight=()=>{document.querySelectorAll(".tab_wrapper").forEach(e=>{let t=e.querySelectorAll(".tabcontent"),i=0,l=0;t.forEach(e=>{let t=e.style.visibility;e.style.visibility="visible";let o=e.style.position,s=e.style.display;e.style.position="relative",e.style.display="inline-block";let y=e.querySelector(".code_in_modal"),r=e.querySelector(".output_in_modal");if(y){y.style.height="auto";let e=y.offsetHeight;e>i&&(i=e)}if(r){r.style.height="auto";let e=r.offsetHeight;e>l&&(l=e)}e.style.visibility=t,e.style.position=o,e.style.display=s}),t.forEach(e=>{let t=e.querySelector(".code_in_modal"),o=e.querySelector(".output_in_modal");t&&(t.style.height=i+"px"),o&&(o.style.height=l+"px")})})};window.addEventListener("load",setHeight),window.addEventListener("resize",setHeight)</script><script>for(var tabWrappers=document.getElementsByClassName("tab_wrapper"),i=0;i<tabWrappers.length;i++)for(var tabWrapper=tabWrappers[i],buttons=tabWrapper.getElementsByClassName("tablink"),tabContents=tabWrapper.getElementsByClassName("tabcontent"),j=0;j<buttons.length;j++){var button=buttons[j],tabContent=tabContents[j],dataId="tab"+(i+1)+"_"+(j+1);button.setAttribute("data-id",dataId),tabContent.setAttribute("data-id",dataId)}</script><script>document.addEventListener("keydown",function(e){if("ArrowUp"===e.code&&e.altKey)for(var n=document.getElementsByTagName("details"),t=0;t<n.length;t++)n[t].open=!1})</script><script>document.addEventListener("keydown",function(e){if("ArrowDown"===e.code&&e.altKey)for(var n=document.getElementsByTagName("details"),o=0;o<n.length;o++)n[o].open=!0}),window.onkeydown=function(e){if("Escape"==e.key)for(let e of modals)e.style.display="none"}</script><style>.pic_drop_green{padding-top:1em;padding-bottom:1em}.pic_drop_green details>summary{color:#fff;display:inline-block;width:auto;cursor:pointer;padding:0 6px;margin:0;border-width:1px;border-style:solid;box-shadow:3px 3px 4px #000;background-color:#3f6b4b}.pic_drop_green details[open]>summary{width:auto;padding:0 6px;border:#a8a8a8;border-width:1px;border-style:solid;color:#fff;background-color:#3f6b4b}.pic_drop_green details>p{display:block;width:auto;padding:0;margin:0}.multiple_pics{text-align:center}.multiple_pics h2{text-decoration:none;padding-bottom:0}.multiple_pics .row{display:flex}.multiple_pics .column2{flex:50%}.multiple_pics .column3{flex:33.33%}</style><script>function generateId(e){return e.toLowerCase().replace(/[^\w\s]/g,"").replace(/\s+/g,"_")}function copyToClipboard(e){const t=document.createElement("input");document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy"),document.body.removeChild(t)}function showTooltip(e,t,n="Link Copied"){const o=document.createElement("div");o.style.position="absolute";const l=document.createElement("span");l.textContent=n,l.style.position="absolute",l.style.background="rgba(63, 99, 136, 0.75)",l.style.color="white",l.style.padding="4px 2px",l.style.borderRadius="4px",l.style.fontSize="14px",l.style.textAlign="center",l.style.fontWeight="700",o.appendChild(l),t.appendChild(o);const i=t.getBoundingClientRect(),c=e.clientX-i.left-28,d=e.clientY-i.bottom-25;l.style.top=`${d}px`,l.style.left=`${c}px`,setTimeout(()=>{t.removeChild(o)},1e3)}function handleH2Elements(){document.querySelectorAll("h2").forEach(e=>{e.addEventListener("click",function(t){const n=e.textContent.trim();copyToClipboard(`${window.location.origin}${window.location.pathname}#${generateId(n)}`),showTooltip(t,e)})})}function handleH4Elements(){document.querySelectorAll("h4").forEach(e=>{const t=`sub_${generateId(e.textContent.trim())}`;e.setAttribute("id",t);const n=document.createElement("a");n.href=`#${t}`,n.innerHTML=e.innerHTML,n.style.textDecoration="underline",e.innerHTML="",e.appendChild(n),n.addEventListener("click",function(t){copyToClipboard(n.href),showTooltip(t,e),t.preventDefault()})})}document.addEventListener("DOMContentLoaded",function(){handleH2Elements(),handleH4Elements()})</script><style>h2,h4{cursor:pointer}.hand-cursor{cursor:wait}h2:hover,h4:hover{color:rgba(0,0,0,.5)}</style><!-- 
#################################################
# FOR EACH SPECIFIC PAGE
#################################################
 --><nav class="nav"><button class="nav-toggle" aria-label="Toggle navigation"><img src="/julia_book/assets/icons/dropdown.png" style="width:auto;height:30px;opacity:.9;padding-bottom:2px;margin-left:0"> <span class="nav-title"><i>10f.</i> SIMD: Branchless Code</span></button><div class="nav-menu"><ul><li><a href="#branches" data-offset="-40">Branches</a></li><li><a href="#type_stability_and_bounds_checking_as_avoidable_conditions" data-offset="-40">Type Stability and Bounds Checking as Avoidable Conditions</a></li><li><a href="#approaches_to_conditional_statements" data-offset="-40">Approaches to Conditional Statements</a></li><li><a href="#ifelse_vs_if" data-offset="-40">ifelse vs if</a></li><li><a href="#ternary_operators" data-offset="-40">Ternary Operators</a></li><li><a href="#scenarios_under_which_each_approach_is_better" data-offset="-40">Scenarios Under Which Each Approach is Better</a></li><li><a href="#vector_of_conditions" data-offset="-40">Vector of Conditions</a></li><li><a href="#algebraic_operations_as_compound_conditions" data-offset="-40">Algebraic Operations as Compound Conditions</a></li></ul></div></nav><script>const navToggle=document.querySelector(".nav-toggle"),navMenu=document.querySelector(".nav-menu"),navLinks=document.querySelectorAll(".nav-menu a");navToggle.addEventListener("click",()=>{navMenu.classList.toggle("show")}),navLinks.forEach(e=>{e.addEventListener("click",n=>{n.preventDefault();const t=document.querySelector(e.getAttribute("href")),o=parseInt(e.dataset.offset,10)||0;window.scrollTo({top:t.offsetTop+o,behavior:"smooth"})})}),document.addEventListener("click",e=>{navMenu.contains(e.target)||navToggle.contains(e.target)||navMenu.classList.remove("show")}),document.addEventListener("keydown",e=>{"Escape"===e.key&&navMenu.classList.remove("show"),"x"===e.key&&e.ctrlKey&&navMenu.classList.toggle("show")})</script><style>.nav{position:fixed;top:0;right:0;z-index:200;background-color:#3f6388;padding:0;display:block;font-family:Inter}.nav-toggle{background-color:#3f6388;border:none;padding:8px;padding-right:24px;font-size:18px;cursor:pointer}.nav-menu{position:fixed;right:0;top:48px;background-color:#3f6388;padding:10px;width:300px;height:100vh;overflow-y:auto;display:none}.nav-menu ul{list-style:none;margin:0;padding:0}.nav-menu li{margin-bottom:10px}.nav-menu a{color:#fff;text-decoration:none;font-size:18px;font-weight:700;text-align:center;padding:10px 10px;display:block}.nav-menu a:hover{color:#fff;background-color:#000}.nav-title{font-size:18px;margin-left:10px;color:#fff}.nav-brand{font-size:24px;font-weight:700;margin:10px 20px;color:#fff}.nav-menu.show{display:block}</style><script src="/julia_book/libs/clipboard.min.js"></script><script>!function(){for(var t=document.getElementsByTagName("pre"),e=0;e<t.length;e++){var n=t[e].children[0].className;if(n.startsWith("language-")||n.endsWith(" hljs")){var o=document.createElement("button");o.className="copy-button",o.textContent="Copy",t[e].appendChild(o)}}var r=new Clipboard(".copy-button",{target:function(t){return t.previousElementSibling}});r.on("success",function(t){t.clearSelection(),t.trigger.textContent="copied!",window.setTimeout(function(){t.trigger.textContent="copy"},2e3)}),r.on("error",function(t){t.trigger.textContent='Press "Ctrl + C" to copy',window.setTimeout(function(){t.trigger.textContent="Copy"},5e3)})}()</script><style>@media print{.franklin-content{box-sizing:border-box}.jumbotron{padding-right:60px!important}.jumbotron,.name_format,.phd_format{color:#000!important}.name_format a{color:#3f6388}.hide_tab details[open] p,.hide_tab>details[open]>summary,.sign_output,.tab_code_links,nav{display:none!important}.bar_top,.bar_top .modalButton,.copy-button,.footn,.left_bar,.left_bar_mobile,.nav-item,.navbar,footer,nav{display:none!important}.tab_wrapper{display:flex!important;flex-wrap:wrap;gap:1cm;width:100%;padding-top:20px;padding-bottom:20px}.tabcontent{display:block!important;margin-bottom:2em;page-break-inside:avoid;border:2px solid #3f6388!important}.print-tab-title{font-weight:700;font-size:100%;padding:0 0;padding-left:.35cm;color:#000;text-transform:uppercase;display:block!important}.code_in_modal,.output_in_modal{width:100%;height:auto!important;overflow:visible;border:none!important}.code_NoFormat pre,.mixed_output_NoFormat pre{border:none!important}.code_NoFormat,.code_in_modal,.julia_repl_NoFormat,.mixed_output_NoFormat,.mixed_output_inline{margin:0!important;padding:0!important}.code_NoFormat,.julia_repl_NoFormat,.mixed_output_NoFormat{padding-left:.35cm!important;padding-top:.15cm!important}.output_in_modal{margin-top:12px!important;border-top:2px solid #20c679!important}.code_NoFormat,.code_in_modal{border-top:2px solid #3f6388}#remarkCodeContent{height:.1px!important;visibility:hidden!important}}</style><script>function printAllTabs(){const t=document.querySelectorAll(".tablink");document.querySelectorAll(".tabcontent").forEach((e,n)=>{const r=t[n].textContent.trim();if(!e.querySelector(".print-tab-title")){const t=document.createElement("div");t.className="print-tab-title",t.textContent=r,e.insertBefore(t,e.firstChild)}});for(var e=document.getElementsByTagName("a"),n=0;n<e.length;n++)e[n].removeAttribute("href"),e[n].style.textDecoration="none"}window.matchMedia("print").addListener(t=>{if(t.matches)printAllTabs();else{document.querySelectorAll(".tabcontent").forEach(t=>{const e=t.querySelector(".print-tab-title");e&&t.removeChild(e)})}})</script>